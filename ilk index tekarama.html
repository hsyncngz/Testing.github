<script>
  fetch('https://raw.githubusercontent.com/hsyncngz/Testing.github/main/veri.json')
    .then(res => res.json())
    .then(data => {
      const arama = document.getElementById('arama');
      const liste = document.getElementById('liste');

      function ilkSatiriGoster() {
        liste.innerHTML = '';
        if (data.length > 0) {
          const ilk = data[0];
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${ilk["Ürün Kodu"]}</td>
            <td>${ilk["Ürün Adı"]}</td>
            <td>${ilk["Liste Fiyatı"]}</td>
            <td>${ilk["Stok Miktarı"]}</td>
          `;
          liste.appendChild(tr);
        }
      }

      function detayliFiltrele() {
        const kelimeler = arama.value.toLowerCase().split(/\s+/).filter(k => k);
        liste.innerHTML = '';

        if (kelimeler.length === 0) {
          ilkSatiriGoster();
          return;
        }

        const filtrelenmis = data.filter((item, index) => {
          if (index === 0) return false; // ilk satırı tekrar gösterme
          const metin = (item["Ürün Adı"] + ' ' + item["Ürün Kodu"]).toLowerCase();
          const stok = parseFloat(item["Stok Miktarı"].replace(',', '.'));
          return kelimeler.every(k => metin.includes(k)) && stok > 0;
        });

        filtrelenmis.forEach(item => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${item["Ürün Kodu"]}</td>
            <td>${item["Ürün Adı"]}</td>
            <td>${item["Liste Fiyatı"]}</td>
            <td>${item["Stok Miktarı"]}</td>
          `;
          liste.appendChild(tr);
        });
      }

      arama.addEventListener('input', detayliFiltrele);
      ilkSatiriGoster(); // Sayfa ilk açıldığında sadece ilk ürün gösterilsin
    })
    .catch(err => {
      document.getElementById('liste').innerHTML = '<tr><td colspan="4">veri.json yüklenemedi.</td></tr>';
      console.error('Hata:', err);
    });
</script>
