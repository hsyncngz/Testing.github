<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DURU Canlı Veri</title>
    <style>
        body { margin: 0; padding: 0; background: transparent; overflow: hidden; }
        .fixed-bottom-bar {
            position: fixed;
            bottom: 0; left: 0; width: 100%;
            background-color: #1a1a1a;
            color: #fff;
            padding: 12px 0;
            white-space: nowrap;
            border-top: 2px solid #333;
        }
        .marquee {
            display: inline-block;
            padding-left: 100%;
            animation: scroll-left 25s linear infinite;
            font-family: 'Arial', sans-serif;
            font-size: 18px;
            font-weight: bold;
        }
        .item { margin-right: 70px; }
        .label { color: #FFD700; margin-right: 5px; }
        @keyframes scroll-left {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }
    </style>
</head>
<body>

    <div class="fixed-bottom-bar">
        <div id="ticker" class="marquee">Veriler güncelleniyor...</div>
    </div>

    <script>
        const url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR2HG_EhDiTB7QAiDqWO5rOxB8RmRwTdVaiNYKCklahAEF3jb0TO4TUss-R5q-lp3byjEDBmKgkuKyP/pub?gid=0&single=true&output=csv';

        function formatTurkish(num) {
            return new Intl.NumberFormat('tr-TR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(num);
        }

        async function updateData() {
            try {
                const response = await fetch(url + '&t=' + Date.now());
                const text = await response.text();
                
                const rows = text.split(/\r?\n/);
                if (rows.length < 2) return;

                // Satırı her türlü ayırıcıdan temizle (virgül veya noktalı virgül fark etmez)
                // Bu kısım satırdaki sayısal blokları bulur
                let dataRow = rows[1];
                let cells = dataRow.split(/[;,]/); // Hem virgül hem noktalı virgüle göre böl

                // Ham verileri temizle (boşlukları sil, sayıya çevir)
                let values = cells.map(c => {
                    let clean = c.trim().replace(/\./g, '').replace(',', '.');
                    return parseFloat(clean) || 0;
                });

                // Sizin sıranız: Bakır (0), USD (1), Euro (2)
                const display = `
                    <span class="item"><span class="label">BAKIR:</span>${formatTurkish(values[0])}</span>
                    <span class="item"><span class="label">USD:</span>${formatTurkish(values[1])}</span>
                    <span class="item"><span class="label">EURO:</span>${formatTurkish(values[2])}</span>
                `;

                document.getElementById('ticker').innerHTML = display + display + display;

            } catch (err) {
                document.getElementById('ticker').innerText = "Yükleniyor...";
            }
        }

        updateData();
        setInterval(updateData, 60000);
    </script>
</body>
</html>
