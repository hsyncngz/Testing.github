<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DURU - Canlı Veri Bandı</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        /* En alta sabitleme ayarları */
        .fixed-bottom-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #333;
            color: #fff;
            padding: 10px 0;
            overflow: hidden;
            z-index: 9999;
            box-shadow: 0 -2px 5px rgba(0,0,0,0.3);
        }

        .marquee-content {
            display: inline-block;
            white-space: nowrap;
            padding-left: 100%;
            animation: marquee 20s linear infinite;
            font-size: 18px;
            font-weight: bold;
        }

        .data-item {
            margin-right: 50px;
        }

        .label { color: #ffcc00; margin-right: 5px; }
        .value { color: #ffffff; }

        @keyframes marquee {
            0% { transform: translate(0, 0); }
            100% { transform: translate(-100%, 0); }
        }

        /* Fare üzerine gelince durması için */
        .fixed-bottom-bar:hover .marquee-content {
            animation-play-state: paused;
        }
    </style>
</head>
<body>

    <div class="fixed-bottom-bar">
        <div id="ticker" class="marquee-content">Veriler yükleniyor...</div>
    </div>

    <script>
        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR2HG_EhDiTB7QAiDqWO5rOxB8RmRwTdVaiNYKCklahAEF3jb0TO4TUss-R5q-lp3byjEDBmKgkuKyP/pub?output=csv';

        // Sayıyı 13.768,25 formatına çeviren fonksiyon
        function formatNumber(numStr) {
            let num = parseFloat(numStr.replace(',', '.')); // CSV'den gelen olası virgülü noktaya çevir
            if (isNaN(num)) return "---";
            
            return new Intl.NumberFormat('tr-TR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(num);
        }

        async function fetchData() {
            try {
                const response = await fetch(csvUrl);
                const data = await response.text();
                
                // Satırları ayır (Başlık: 0, Veri: 1)
                const rows = data.split('\n');
                if (rows.length > 1) {
                    const values = rows[1].split(','); // Virgülle ayrılmış değerler
                    
                    const bakir = formatNumber(values[0]);
                    const usd = formatNumber(values[1]);
                    const euro = formatNumber(values[2]);

                    const tickerHtml = `
                        <span class="data-item"><span class="label">BAKIR:</span><span class="value">${bakir}</span></span>
                        <span class="data-item"><span class="label">USD:</span><span class="value">${usd}</span></span>
                        <span class="data-item"><span class="label">EURO:</span><span class="value">${euro}</span></span>
                        <span class="data-item"><span class="label">BAKIR:</span><span class="value">${bakir}</span></span>
                    `;
                    
                    document.getElementById('ticker').innerHTML = tickerHtml + tickerHtml; // Süreklilik için tekrarla
                }
            } catch (error) {
                console.error('Veri çekme hatası:', error);
                document.getElementById('ticker').innerText = "Veri güncellenemedi.";
            }
        }

        // Veriyi ilk açılışta çek ve her 1 dakikada bir güncelle
        fetchData();
        setInterval(fetchData, 60000);
    </script>
</body>
</html>
